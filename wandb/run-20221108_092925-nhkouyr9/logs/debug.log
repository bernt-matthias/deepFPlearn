2022-11-08 09:29:25,677 INFO    MainThread:28241 [wandb_setup.py:_flush():68] Configure stats pid to 28241
2022-11-08 09:29:25,677 INFO    MainThread:28241 [wandb_setup.py:_flush():68] Loading settings from /home/soulios/.config/wandb/settings
2022-11-08 09:29:25,677 INFO    MainThread:28241 [wandb_setup.py:_flush():68] Loading settings from /home/soulios/git-hzdr-soulios/deepFPlearn/wandb/settings
2022-11-08 09:29:25,678 INFO    MainThread:28241 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'_require_service': 'True'}
2022-11-08 09:29:25,678 WARNING MainThread:28241 [wandb_setup.py:_flush():68] Could not find program at -m dfpl.__main__
2022-11-08 09:29:25,678 INFO    MainThread:28241 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': None, 'program': '-m dfpl.__main__'}
2022-11-08 09:29:25,678 INFO    MainThread:28241 [wandb_init.py:_log_setup():476] Logging user logs to /home/soulios/git-hzdr-soulios/deepFPlearn/wandb/run-20221108_092925-nhkouyr9/logs/debug.log
2022-11-08 09:29:25,678 INFO    MainThread:28241 [wandb_init.py:_log_setup():477] Logging internal logs to /home/soulios/git-hzdr-soulios/deepFPlearn/wandb/run-20221108_092925-nhkouyr9/logs/debug-internal.log
2022-11-08 09:29:25,686 INFO    MainThread:28241 [wandb_init.py:init():516] calling init triggers
2022-11-08 09:29:25,690 INFO    MainThread:28241 [wandb_init.py:init():519] wandb.init called with sweep_config: {}
config: {'_initialized': True, '_explicit_bool': False, '_underscores_to_dashes': False, '_parsed': True, 'extra_args': ['traindmpnn', 'True'], 'argument_buffer': OrderedDict([('help', (('-h', '--help'), {'action': 'help', 'default': '==SUPPRESS==', 'help': 'show this help message and exit'})), ('gpu', (('--gpu',), {'choices': []})), ('features_generator', (('--features_generator',), {'choices': ['morgan', 'morgan_count', 'rdkit_2d', 'rdkit_2d_normalized']}))]), '_subparser_buffer': [], 'class_variables': OrderedDict([('data_path', {'comment': 'Path to data CSV file.'}), ('target_columns', {'comment': 'Name of the columns containing target values.\n    By default, uses all columns except the SMILES column and the :code:`ignore_columns`.'}), ('ignore_columns', {'comment': 'Name of the columns to ignore when :code:`target_columns` is not provided.'}), ('dataset_type', {'comment': 'Type of dataset. This determines the default loss function used during training.'}), ('loss_function', {'comment': 'Choice of loss function. Loss functions are limited to compatible dataset types.'}), ('multiclass_num_classes', {'comment': 'Number of classes when running multiclass classification.'}), ('separate_val_path', {'comment': 'Path to separate val set, optional.'}), ('separate_test_path', {'comment': 'Path to separate test set, optional.'}), ('spectra_phase_mask_path', {'comment': 'Path to a file containing a phase mask array, used for excluding particular regions in spectra predictions.'}), ('data_weights_path', {'comment': 'Path to weights for each molecule in the training data, affecting the relative weight of molecules in the loss function'}), ('target_weights', {'comment': 'Weights associated with each target, affecting the relative weight of targets in the loss function. Must match the number of target columns.'}), ('split_type', {'comment': 'Method of splitting the data into train/val/test.'}), ('split_sizes', {'comment': 'Split proportions for train/validation/test sets.'}), ('split_key_molecule', {'comment': 'The index of the key molecule used for splitting when multiple molecules are present and constrained split_type is used, like scaffold_balanced or random_with_repeated_smiles.\n       Note that this index begins with zero for the first molecule.'}), ('num_folds', {'comment': 'Number of folds when performing cross validation.'}), ('folds_file', {'comment': 'Optional file of fold labels.'}), ('val_fold_index', {'comment': 'Which fold to use as val for leave-one-out cross val.'}), ('test_fold_index', {'comment': 'Which fold to use as test for leave-one-out cross val.'}), ('crossval_index_dir', {'comment': 'Directory in which to find cross validation index files.'}), ('crossval_index_file', {'comment': 'Indices of files to use as train/val/test. Overrides :code:`--num_folds` and :code:`--seed`.'}), ('seed', {'comment': 'Random seed to use when splitting data into train/val/test sets.\n    When :code`num_folds > 1`, the first fold uses this seed and all subsequent folds add 1 to the seed.'}), ('pytorch_seed', {'comment': 'Seed for PyTorch randomness (e.g., random initial weights).'}), ('metric', {'comment': 'Metric to use during evaluation. It is also used with the validation set for early stopping.\n    Defaults to "auc" for classification, "rmse" for regression, and "sid" for spectra.'}), ('extra_metrics', {'comment': 'Additional metrics to use to evaluate the model. Not used for early stopping.'}), ('save_dir', {'comment': 'Directory where model checkpoints will be saved.'}), ('checkpoint_frzn', {'comment': 'Path to model checkpoint file to be loaded for overwriting and freezing weights.'}), ('save_smiles_splits', {'comment': 'Save smiles for each train/val/test splits for prediction convenience later.'}), ('test', {'comment': 'Whether to skip training and only test the model.'}), ('quiet', {'comment': 'Skip non-essential print statements.'}), ('log_frequency', {'comment': 'The number of batches between each logging of the training loss.'}), ('show_individual_scores', {'comment': 'Show all scores for individual targets, not just average, at the end.'}), ('cache_cutoff', {'comment': 'Maximum number of molecules in dataset to allow caching.\n    Below this number, caching is used and data loading is sequential.\n    Above this number, caching is not used and data loading is parallel.\n    Use "inf" to always cache.'}), ('save_preds', {'comment': 'Whether to save test split predictions during training.'}), ('resume_experiment', {'comment': 'Whether to resume the experiment.\n    Loads test results from any folds that have already been completed and skips training those folds.'}), ('bias', {'comment': 'Whether to add bias to linear layers.'}), ('hidden_size', {'comment': 'Dimensionality of hidden layers in MPN.'}), ('depth', {'comment': 'Number of message passing steps.'}), ('bias_solvent', {'comment': 'Whether to add bias to linear layers for solvent MPN if :code:`reaction_solvent` is True.'}), ('hidden_size_solvent', {'comment': 'Dimensionality of hidden layers in solvent MPN if :code:`reaction_solvent` is True.'}), ('depth_solvent', {'comment': 'Number of message passing steps for solvent if :code:`reaction_solvent` is True.'}), ('mpn_shared', {'comment': 'Whether to use the same message passing neural network for all input molecules\n    Only relevant if :code:`number_of_molecules > 1`'}), ('dropout', {'comment': 'Dropout probability.'}), ('activation', {'comment': 'Activation function.'}), ('atom_messages', {'comment': 'Centers messages on atoms instead of on bonds.'}), ('undirected', {'comment': 'Undirected edges (always sum the two relevant bond vectors).'}), ('ffn_hidden_size', {'comment': 'Hidden dim for higher-capacity FFN (defaults to hidden_size).'}), ('ffn_num_layers', {'comment': 'Number of layers in FFN after MPN encoding.'}), ('features_only', {'comment': 'Use only the additional features in an FFN, no graph network.'}), ('separate_val_features_path', {'comment': 'Path to file with features for separate val set.'}), ('separate_test_features_path', {'comment': 'Path to file with features for separate test set.'}), ('separate_val_phase_features_path', {'comment': 'Path to file with phase features for separate val set.'}), ('separate_test_phase_features_path', {'comment': 'Path to file with phase features for separate test set.'}), ('separate_val_atom_descriptors_path', {'comment': 'Path to file with extra atom descriptors for separate val set.'}), ('separate_test_atom_descriptors_path', {'comment': 'Path to file with extra atom descriptors for separate test set.'}), ('separate_val_bond_features_path', {'comment': 'Path to file with extra atom descriptors for separate val set.'}), ('separate_test_bond_features_path', {'comment': 'Path to file with extra atom descriptors for separate test set.'}), ('config_path', {'comment': 'Path to a :code:`.json` file containing arguments. Any arguments present in the config file\n    will override arguments specified via the command line or by the defaults.'}), ('ensemble_size', {'comment': 'Number of models in ensemble.'}), ('aggregation', {'comment': 'Aggregation scheme for atomic vectors into molecular vectors'}), ('aggregation_norm', {'comment': 'For norm aggregation, number by which to divide summed up atomic features'}), ('reaction', {'comment': 'Whether to adjust MPNN layer to take reactions as input instead of molecules.'}), ('reaction_mode', {'comment': 'Choices for construction of atom and bond features for reactions\n    :code:`reac_prod`: concatenates the reactants feature with the products feature.\n    :code:`reac_diff`: concatenates the reactants feature with the difference in features between reactants and products.\n    :code:`prod_diff`: concatenates the products feature with the difference in features between reactants and products.\n    :code:`reac_prod_balance`: concatenates the reactants feature with the products feature, balances imbalanced reactions.\n    :code:`reac_diff_balance`: concatenates the reactants feature with the difference in features between reactants and products, balances imbalanced reactions.\n    :code:`prod_diff_balance`: concatenates the products feature with the difference in features between reactants and products, balances imbalanced reactions.'}), ('reaction_solvent', {'comment': 'Whether to adjust the MPNN layer to take as input a reaction and a molecule, and to encode them with separate MPNNs.'}), ('explicit_h', {'comment': 'Whether H are explicitly specified in input (and should be kept this way). This option is intended to be used\n    with the :code:`reaction` or :code:`reaction_solvent` options, and applies only to the reaction part.'}), ('adding_h', {'comment': "Whether RDKit molecules will be constructed with adding the Hs to them. This option is intended to be used\n    with Chemprop's default molecule or multi-molecule encoders, or in :code:`reaction_solvent` mode where it applies to the solvent only."}), ('epochs', {'comment': 'Number of epochs to run.'}), ('warmup_epochs', {'comment': 'Number of epochs during which learning rate increases linearly from :code:`init_lr` to :code:`max_lr`.\n    Afterwards, learning rate decreases exponentially from :code:`max_lr` to :code:`final_lr`.'}), ('init_lr', {'comment': 'Initial learning rate.'}), ('max_lr', {'comment': 'Maximum learning rate.'}), ('final_lr', {'comment': 'Final learning rate.'}), ('grad_clip', {'comment': 'Maximum magnitude of gradient during training.'}), ('class_balance', {'comment': 'Trains with an equal number of positives and negatives in each batch.'}), ('spectra_activation', {'comment': 'Indicates which function to use in dataset_type spectra training to constrain outputs to be positive.'}), ('spectra_target_floor', {'comment': 'Values in targets for dataset type spectra are replaced with this value, intended to be a small positive number used to enforce positive values.'}), ('evidential_regularization', {'comment': 'Value used in regularization for evidential loss function. Value used in literature was 1.'}), ('overwrite_default_atom_features', {'comment': 'Overwrites the default atom descriptors with the new ones instead of concatenating them.\n    Can only be used if atom_descriptors are used as a feature.'}), ('no_atom_descriptor_scaling', {'comment': 'Turn off atom feature scaling.'}), ('overwrite_default_bond_features', {'comment': 'Overwrites the default atom descriptors with the new ones instead of concatenating them'}), ('no_bond_features_scaling', {'comment': 'Turn off atom feature scaling.'}), ('frzn_ffn_layers', {'comment': 'Overwrites weights for the first n layers of the ffn from checkpoint model (specified checkpoint_frzn),\n    where n is specified in the input.\n    Automatically also freezes mpnn weights.'}), ('freeze_first_only', {'comment': 'Determines whether or not to use checkpoint_frzn for just the first encoder.\n    Default (False) is to use the checkpoint to freeze all encoders.\n    (only relevant for number_of_molecules > 1, where checkpoint model has number_of_molecules = 1)'}), ('smiles_columns', {'comment': 'List of names of the columns containing SMILES strings.\n    By default, uses the first :code:`number_of_molecules` columns.'}), ('number_of_molecules', {'comment': 'Number of molecules in each input to the model.\n    This must equal the length of :code:`smiles_columns` (if not :code:`None`).'}), ('checkpoint_dir', {'comment': 'Directory from which to load model checkpoints (walks directory and ensembles all models that are found).'}), ('checkpoint_path', {'comment': 'Path to model checkpoint (:code:`.pt` file).'}), ('checkpoint_paths', {'comment': 'List of paths to model checkpoints (:code:`.pt` files).'}), ('no_cuda', {'comment': 'Turn off cuda (i.e., use CPU instead of GPU).'}), ('gpu', {'comment': 'Which GPU to use.'}), ('features_generator', {'comment': 'Method(s) of generating additional features.'}), ('features_path', {'comment': 'Path(s) to features to use in FNN (instead of features_generator).'}), ('phase_features_path', {'comment': 'Path to features used to indicate the phase of the data in one-hot vector form. Used in spectra datatype.'}), ('no_features_scaling', {'comment': 'Turn off scaling of features.'}), ('max_data_size', {'comment': 'Maximum number of data points to load.'}), ('num_workers', {'comment': 'Number of workers for the parallel data loading (0 means sequential).'}), ('batch_size', {'comment': 'Batch size.'}), ('atom_descriptors', {'comment': 'Custom extra atom descriptors.\n    :code:`feature`: used as atom features to featurize a given molecule.\n    :code:`descriptor`: used as descriptor and concatenated to the machine learned atomic representation.'}), ('atom_descriptors_path', {'comment': 'Path to the extra atom descriptors.'}), ('bond_features_path', {'comment': 'Path to the extra bond descriptors that will be used as bond features to featurize a given molecule.'}), ('no_cache_mol', {'comment': 'Whether to not cache the RDKit molecule for each SMILES string to reduce memory usage (cached by default).'}), ('empty_cache', {'comment': 'Whether to empty all caches before training or predicting. This is necessary if multiple jobs are run within a single script and the atom or bond features change.'})]), '_annotations': {'smiles_columns': typing.List[str], 'number_of_molecules': <class 'int'>, 'checkpoint_dir': <class 'str'>, 'checkpoint_path': <class 'str'>, 'checkpoint_paths': typing.List[str], 'no_cuda': <class 'bool'>, 'gpu': <class 'int'>, 'features_generator': typing.List[str], 'features_path': typing.List[str], 'phase_features_path': <class 'str'>, 'no_features_scaling': <class 'bool'>, 'max_data_size': <class 'int'>, 'num_workers': <class 'int'>, 'batch_size': <class 'int'>, 'atom_descriptors': typing.Literal['feature', 'descriptor'], 'atom_descriptors_path': <class 'str'>, 'bond_features_path': <class 'str'>, 'no_cache_mol': <class 'bool'>, 'empty_cache': <class 'bool'>, 'data_path': <class 'str'>, 'target_columns': typing.List[str], 'ignore_columns': typing.List[str], 'dataset_type': typing.Literal['regression', 'classification', 'multiclass', 'spectra'], 'loss_function': typing.Literal['mse', 'bounded_mse', 'binary_cross_entropy', 'cross_entropy', 'mcc', 'sid', 'wasserstein', 'mve', 'evidential', 'dirichlet'], 'multiclass_num_classes': <class 'int'>, 'separate_val_path': <class 'str'>, 'separate_test_path': <class 'str'>, 'spectra_phase_mask_path': <class 'str'>, 'data_weights_path': <class 'str'>, 'target_weights': typing.List[float], 'split_type': typing.Literal['random', 'scaffold_balanced', 'predetermined', 'crossval', 'cv', 'cv-no-test', 'index_predetermined', 'random_with_repeated_smiles'], 'split_sizes': typing.List[float], 'split_key_molecule': <class 'int'>, 'num_folds': <class 'int'>, 'folds_file': <class 'str'>, 'val_fold_index': <class 'int'>, 'test_fold_index': <class 'int'>, 'crossval_index_dir': <class 'str'>, 'crossval_index_file': <class 'str'>, 'seed': <class 'int'>, 'pytorch_seed': <class 'int'>, 'metric': typing.Literal['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse'], 'extra_metrics': typing.List[typing.Literal['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse']], 'save_dir': <class 'str'>, 'checkpoint_frzn': <class 'str'>, 'save_smiles_splits': <class 'bool'>, 'test': <class 'bool'>, 'quiet': <class 'bool'>, 'log_frequency': <class 'int'>, 'show_individual_scores': <class 'bool'>, 'cache_cutoff': <class 'float'>, 'save_preds': <class 'bool'>, 'resume_experiment': <class 'bool'>, 'bias': <class 'bool'>, 'hidden_size': <class 'int'>, 'depth': <class 'int'>, 'bias_solvent': <class 'bool'>, 'hidden_size_solvent': <class 'int'>, 'depth_solvent': <class 'int'>, 'mpn_shared': <class 'bool'>, 'dropout': <class 'float'>, 'activation': typing.Literal['ReLU', 'LeakyReLU', 'PReLU', 'tanh', 'SELU', 'ELU'], 'atom_messages': <class 'bool'>, 'undirected': <class 'bool'>, 'ffn_hidden_size': <class 'int'>, 'ffn_num_layers': <class 'int'>, 'features_only': <class 'bool'>, 'separate_val_features_path': typing.List[str], 'separate_test_features_path': typing.List[str], 'separate_val_phase_features_path': <class 'str'>, 'separate_test_phase_features_path': <class 'str'>, 'separate_val_atom_descriptors_path': <class 'str'>, 'separate_test_atom_descriptors_path': <class 'str'>, 'separate_val_bond_features_path': <class 'str'>, 'separate_test_bond_features_path': <class 'str'>, 'config_path': <class 'str'>, 'ensemble_size': <class 'int'>, 'aggregation': typing.Literal['mean', 'sum', 'norm'], 'aggregation_norm': <class 'int'>, 'reaction': <class 'bool'>, 'reaction_mode': typing.Literal['reac_prod', 'reac_diff', 'prod_diff', 'reac_prod_balance', 'reac_diff_balance', 'prod_diff_balance'], 'reaction_solvent': <class 'bool'>, 'explicit_h': <class 'bool'>, 'adding_h': <class 'bool'>, 'epochs': <class 'int'>, 'warmup_epochs': <class 'float'>, 'init_lr': <class 'float'>, 'max_lr': <class 'float'>, 'final_lr': <class 'float'>, 'grad_clip': <class 'float'>, 'class_balance': <class 'bool'>, 'spectra_activation': typing.Literal['exp', 'softplus'], 'spectra_target_floor': <class 'float'>, 'evidential_regularization': <class 'float'>, 'overwrite_default_atom_features': <class 'bool'>, 'no_atom_descriptor_scaling': <class 'bool'>, 'overwrite_default_bond_features': <class 'bool'>, 'no_bond_features_scaling': <class 'bool'>, 'frzn_ffn_layers': <class 'int'>, 'freeze_first_only': <class 'bool'>}, 'description': None, 'argument_default': None, 'prefix_chars': '-', 'conflict_handler': 'error', '_registries': {'action': {None: <class 'argparse._StoreAction'>, 'store': <class 'argparse._StoreAction'>, 'store_const': <class 'argparse._StoreConstAction'>, 'store_true': <class 'argparse._StoreTrueAction'>, 'store_false': <class 'argparse._StoreFalseAction'>, 'append': <class 'argparse._AppendAction'>, 'append_const': <class 'argparse._AppendConstAction'>, 'count': <class 'argparse._CountAction'>, 'help': <class 'argparse._HelpAction'>, 'version': <class 'argparse._VersionAction'>, 'parsers': <class 'argparse._SubParsersAction'>, 'extend': <class 'argparse._ExtendAction'>}, 'type': {None: <function ArgumentParser.__init__.<locals>.identity at 0x7f4b67205dc0>}}, '_actions': [_StoreAction(option_strings=['--data_path'], dest='data_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, required) Path to data CSV file.', metavar=None), _StoreAction(option_strings=['--target_columns'], dest='target_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Name of the columns containing target values.\n    By default, uses all columns except the SMILES column and the :code:`ignore_columns`.', metavar=None), _StoreAction(option_strings=['--ignore_columns'], dest='ignore_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Name of the columns to ignore when :code:`target_columns` is not provided.', metavar=None), _StoreAction(option_strings=['--dataset_type'], dest='dataset_type', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205ee0>, choices=['regression', 'classification', 'multiclass', 'spectra'], help="(Literal['regression', 'classification', 'multiclass', 'spectra'], required) Type of dataset. This determines the default loss function used during training.", metavar=None), _StoreAction(option_strings=['--loss_function'], dest='loss_function', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205f70>, choices=['mse', 'bounded_mse', 'binary_cross_entropy', 'cross_entropy', 'mcc', 'sid', 'wasserstein', 'mve', 'evidential', 'dirichlet'], help="(Literal['mse', 'bounded_mse', 'binary_cross_entropy', 'cross_entropy', 'mcc', 'sid', 'wasserstein', 'mve', 'evidential', 'dirichlet'], default=None) Choice of loss function. Loss functions are limited to compatible dataset types.", metavar=None), _StoreAction(option_strings=['--multiclass_num_classes'], dest='multiclass_num_classes', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of classes when running multiclass classification.', metavar=None), _StoreAction(option_strings=['--separate_val_path'], dest='separate_val_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to separate val set, optional.', metavar=None), _StoreAction(option_strings=['--separate_test_path'], dest='separate_test_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to separate test set, optional.', metavar=None), _StoreAction(option_strings=['--spectra_phase_mask_path'], dest='spectra_phase_mask_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to a file containing a phase mask array, used for excluding particular regions in spectra predictions.', metavar=None), _StoreAction(option_strings=['--data_weights_path'], dest='data_weights_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to weights for each molecule in the training data, affecting the relative weight of molecules in the loss function', metavar=None), _StoreAction(option_strings=['--target_weights'], dest='target_weights', nargs='*', const=None, default=None, type=<class 'float'>, choices=None, help='(List[float], default=None) Weights associated with each target, affecting the relative weight of targets in the loss function. Must match the number of target columns.', metavar=None), _StoreAction(option_strings=['--split_type'], dest='split_type', nargs=None, const=None, default='random', type=<function get_literals.<locals>.var_type at 0x7f4b67205e50>, choices=['random', 'scaffold_balanced', 'predetermined', 'crossval', 'cv', 'cv-no-test', 'index_predetermined', 'random_with_repeated_smiles'], help="(Literal['random', 'scaffold_balanced', 'predetermined', 'crossval', 'cv', 'cv-no-test', 'index_predetermined', 'random_with_repeated_smiles'], default=random) Method of splitting the data into train/val/test.", metavar=None), _StoreAction(option_strings=['--split_sizes'], dest='split_sizes', nargs='*', const=None, default=None, type=<class 'float'>, choices=None, help='(List[float], default=None) Split proportions for train/validation/test sets.', metavar=None), _StoreAction(option_strings=['--split_key_molecule'], dest='split_key_molecule', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) The index of the key molecule used for splitting when multiple molecules are present and constrained split_type is used, like scaffold_balanced or random_with_repeated_smiles.\n       Note that this index begins with zero for the first molecule.', metavar=None), _StoreAction(option_strings=['--num_folds'], dest='num_folds', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of folds when performing cross validation.', metavar=None), _StoreAction(option_strings=['--folds_file'], dest='folds_file', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Optional file of fold labels.', metavar=None), _StoreAction(option_strings=['--val_fold_index'], dest='val_fold_index', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Which fold to use as val for leave-one-out cross val.', metavar=None), _StoreAction(option_strings=['--test_fold_index'], dest='test_fold_index', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Which fold to use as test for leave-one-out cross val.', metavar=None), _StoreAction(option_strings=['--crossval_index_dir'], dest='crossval_index_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory in which to find cross validation index files.', metavar=None), _StoreAction(option_strings=['--crossval_index_file'], dest='crossval_index_file', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Indices of files to use as train/val/test. Overrides :code:`--num_folds` and :code:`--seed`.', metavar=None), _StoreAction(option_strings=['--seed'], dest='seed', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Random seed to use when splitting data into train/val/test sets.\n    When :code`num_folds > 1`, the first fold uses this seed and all subsequent folds add 1 to the seed.', metavar=None), _StoreAction(option_strings=['--pytorch_seed'], dest='pytorch_seed', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Seed for PyTorch randomness (e.g., random initial weights).', metavar=None), _StoreAction(option_strings=['--metric'], dest='metric', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205d30>, choices=['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse'], help='(Literal[\'auc\', \'prc-auc\', \'rmse\', \'mae\', \'mse\', \'r2\', \'accuracy\', \'cross_entropy\', \'binary_cross_entropy\', \'sid\', \'wasserstein\', \'f1\', \'mcc\', \'bounded_rmse\', \'bounded_mae\', \'bounded_mse\'], default=None) Metric to use during evaluation. It is also used with the validation set for early stopping.\n    Defaults to "auc" for classification, "rmse" for regression, and "sid" for spectra.', metavar=None), _StoreAction(option_strings=['--extra_metrics'], dest='extra_metrics', nargs='*', const=None, default=[], type=<function get_literals.<locals>.var_type at 0x7f4b67205b80>, choices=['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse'], help="(List[Literal['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse']], default=[]) Additional metrics to use to evaluate the model. Not used for early stopping.", metavar=None), _StoreAction(option_strings=['--save_dir'], dest='save_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory where model checkpoints will be saved.', metavar=None), _StoreAction(option_strings=['--checkpoint_frzn'], dest='checkpoint_frzn', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to model checkpoint file to be loaded for overwriting and freezing weights.', metavar=None), _StoreTrueAction(option_strings=['--save_smiles_splits'], dest='save_smiles_splits', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Save smiles for each train/val/test splits for prediction convenience later.', metavar=None), _StoreTrueAction(option_strings=['--test'], dest='test', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to skip training and only test the model.', metavar=None), _StoreTrueAction(option_strings=['--quiet'], dest='quiet', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Skip non-essential print statements.', metavar=None), _StoreAction(option_strings=['--log_frequency'], dest='log_frequency', nargs=None, const=None, default=10, type=<class 'int'>, choices=None, help='(int, default=10) The number of batches between each logging of the training loss.', metavar=None), _StoreTrueAction(option_strings=['--show_individual_scores'], dest='show_individual_scores', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Show all scores for individual targets, not just average, at the end.', metavar=None), _StoreAction(option_strings=['--cache_cutoff'], dest='cache_cutoff', nargs=None, const=None, default=10000, type=<class 'float'>, choices=None, help='(float, default=10000) Maximum number of molecules in dataset to allow caching.\n    Below this number, caching is used and data loading is sequential.\n    Above this number, caching is not used and data loading is parallel.\n    Use "inf" to always cache.', metavar=None), _StoreTrueAction(option_strings=['--save_preds'], dest='save_preds', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to save test split predictions during training.', metavar=None), _StoreTrueAction(option_strings=['--resume_experiment'], dest='resume_experiment', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to resume the experiment.\n    Loads test results from any folds that have already been completed and skips training those folds.', metavar=None), _StoreTrueAction(option_strings=['--bias'], dest='bias', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to add bias to linear layers.', metavar=None), _StoreAction(option_strings=['--hidden_size'], dest='hidden_size', nargs=None, const=None, default=300, type=<class 'int'>, choices=None, help='(int, default=300) Dimensionality of hidden layers in MPN.', metavar=None), _StoreAction(option_strings=['--depth'], dest='depth', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of message passing steps.', metavar=None), _StoreTrueAction(option_strings=['--bias_solvent'], dest='bias_solvent', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to add bias to linear layers for solvent MPN if :code:`reaction_solvent` is True.', metavar=None), _StoreAction(option_strings=['--hidden_size_solvent'], dest='hidden_size_solvent', nargs=None, const=None, default=300, type=<class 'int'>, choices=None, help='(int, default=300) Dimensionality of hidden layers in solvent MPN if :code:`reaction_solvent` is True.', metavar=None), _StoreAction(option_strings=['--depth_solvent'], dest='depth_solvent', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of message passing steps for solvent if :code:`reaction_solvent` is True.', metavar=None), _StoreTrueAction(option_strings=['--mpn_shared'], dest='mpn_shared', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to use the same message passing neural network for all input molecules\n    Only relevant if :code:`number_of_molecules > 1`', metavar=None), _StoreAction(option_strings=['--dropout'], dest='dropout', nargs=None, const=None, default=0.0, type=<class 'float'>, choices=None, help='(float, default=0.0) Dropout probability.', metavar=None), _StoreAction(option_strings=['--activation'], dest='activation', nargs=None, const=None, default='ReLU', type=<function get_literals.<locals>.var_type at 0x7f4b67205af0>, choices=['ReLU', 'LeakyReLU', 'PReLU', 'tanh', 'SELU', 'ELU'], help="(Literal['ReLU', 'LeakyReLU', 'PReLU', 'tanh', 'SELU', 'ELU'], default=ReLU) Activation function.", metavar=None), _StoreTrueAction(option_strings=['--atom_messages'], dest='atom_messages', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Centers messages on atoms instead of on bonds.', metavar=None), _StoreTrueAction(option_strings=['--undirected'], dest='undirected', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Undirected edges (always sum the two relevant bond vectors).', metavar=None), _StoreAction(option_strings=['--ffn_hidden_size'], dest='ffn_hidden_size', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Hidden dim for higher-capacity FFN (defaults to hidden_size).', metavar=None), _StoreAction(option_strings=['--ffn_num_layers'], dest='ffn_num_layers', nargs=None, const=None, default=2, type=<class 'int'>, choices=None, help='(int, default=2) Number of layers in FFN after MPN encoding.', metavar=None), _StoreTrueAction(option_strings=['--features_only'], dest='features_only', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Use only the additional features in an FFN, no graph network.', metavar=None), _StoreAction(option_strings=['--separate_val_features_path'], dest='separate_val_features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path to file with features for separate val set.', metavar=None), _StoreAction(option_strings=['--separate_test_features_path'], dest='separate_test_features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path to file with features for separate test set.', metavar=None), _StoreAction(option_strings=['--separate_val_phase_features_path'], dest='separate_val_phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with phase features for separate val set.', metavar=None), _StoreAction(option_strings=['--separate_test_phase_features_path'], dest='separate_test_phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with phase features for separate test set.', metavar=None), _StoreAction(option_strings=['--separate_val_atom_descriptors_path'], dest='separate_val_atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate val set.', metavar=None), _StoreAction(option_strings=['--separate_test_atom_descriptors_path'], dest='separate_test_atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate test set.', metavar=None), _StoreAction(option_strings=['--separate_val_bond_features_path'], dest='separate_val_bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate val set.', metavar=None), _StoreAction(option_strings=['--separate_test_bond_features_path'], dest='separate_test_bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate test set.', metavar=None), _StoreAction(option_strings=['--config_path'], dest='config_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to a :code:`.json` file containing arguments. Any arguments present in the config file\n    will override arguments specified via the command line or by the defaults.', metavar=None), _StoreAction(option_strings=['--ensemble_size'], dest='ensemble_size', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of models in ensemble.', metavar=None), _StoreAction(option_strings=['--aggregation'], dest='aggregation', nargs=None, const=None, default='mean', type=<function get_literals.<locals>.var_type at 0x7f4b67205160>, choices=['mean', 'sum', 'norm'], help="(Literal['mean', 'sum', 'norm'], default=mean) Aggregation scheme for atomic vectors into molecular vectors", metavar=None), _StoreAction(option_strings=['--aggregation_norm'], dest='aggregation_norm', nargs=None, const=None, default=100, type=<class 'int'>, choices=None, help='(int, default=100) For norm aggregation, number by which to divide summed up atomic features', metavar=None), _StoreTrueAction(option_strings=['--reaction'], dest='reaction', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to adjust MPNN layer to take reactions as input instead of molecules.', metavar=None), _StoreAction(option_strings=['--reaction_mode'], dest='reaction_mode', nargs=None, const=None, default='reac_diff', type=<function get_literals.<locals>.var_type at 0x7f4b67205280>, choices=['reac_prod', 'reac_diff', 'prod_diff', 'reac_prod_balance', 'reac_diff_balance', 'prod_diff_balance'], help="(Literal['reac_prod', 'reac_diff', 'prod_diff', 'reac_prod_balance', 'reac_diff_balance', 'prod_diff_balance'], default=reac_diff) Choices for construction of atom and bond features for reactions\n    :code:`reac_prod`: concatenates the reactants feature with the products feature.\n    :code:`reac_diff`: concatenates the reactants feature with the difference in features between reactants and products.\n    :code:`prod_diff`: concatenates the products feature with the difference in features between reactants and products.\n    :code:`reac_prod_balance`: concatenates the reactants feature with the products feature, balances imbalanced reactions.\n    :code:`reac_diff_balance`: concatenates the reactants feature with the difference in features between reactants and products, balances imbalanced reactions.\n    :code:`prod_diff_balance`: concatenates the products feature with the difference in features between reactants and products, balances imbalanced reactions.", metavar=None), _StoreTrueAction(option_strings=['--reaction_solvent'], dest='reaction_solvent', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to adjust the MPNN layer to take as input a reaction and a molecule, and to encode them with separate MPNNs.', metavar=None), _StoreTrueAction(option_strings=['--explicit_h'], dest='explicit_h', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether H are explicitly specified in input (and should be kept this way). This option is intended to be used\n    with the :code:`reaction` or :code:`reaction_solvent` options, and applies only to the reaction part.', metavar=None), _StoreTrueAction(option_strings=['--adding_h'], dest='adding_h', nargs=0, const=True, default=False, type=None, choices=None, help="(bool, default=False) Whether RDKit molecules will be constructed with adding the Hs to them. This option is intended to be used\n    with Chemprop's default molecule or multi-molecule encoders, or in :code:`reaction_solvent` mode where it applies to the solvent only.", metavar=None), _StoreAction(option_strings=['--epochs'], dest='epochs', nargs=None, const=None, default=30, type=<class 'int'>, choices=None, help='(int, default=30) Number of epochs to run.', metavar=None), _StoreAction(option_strings=['--warmup_epochs'], dest='warmup_epochs', nargs=None, const=None, default=2.0, type=<class 'float'>, choices=None, help='(float, default=2.0) Number of epochs during which learning rate increases linearly from :code:`init_lr` to :code:`max_lr`.\n    Afterwards, learning rate decreases exponentially from :code:`max_lr` to :code:`final_lr`.', metavar=None), _StoreAction(option_strings=['--init_lr'], dest='init_lr', nargs=None, const=None, default=0.0001, type=<class 'float'>, choices=None, help='(float, default=0.0001) Initial learning rate.', metavar=None), _StoreAction(option_strings=['--max_lr'], dest='max_lr', nargs=None, const=None, default=0.001, type=<class 'float'>, choices=None, help='(float, default=0.001) Maximum learning rate.', metavar=None), _StoreAction(option_strings=['--final_lr'], dest='final_lr', nargs=None, const=None, default=0.0001, type=<class 'float'>, choices=None, help='(float, default=0.0001) Final learning rate.', metavar=None), _StoreAction(option_strings=['--grad_clip'], dest='grad_clip', nargs=None, const=None, default=None, type=<class 'float'>, choices=None, help='(float, default=None) Maximum magnitude of gradient during training.', metavar=None), _StoreTrueAction(option_strings=['--class_balance'], dest='class_balance', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Trains with an equal number of positives and negatives in each batch.', metavar=None), _StoreAction(option_strings=['--spectra_activation'], dest='spectra_activation', nargs=None, const=None, default='exp', type=<function get_literals.<locals>.var_type at 0x7f4b672eb280>, choices=['exp', 'softplus'], help="(Literal['exp', 'softplus'], default=exp) Indicates which function to use in dataset_type spectra training to constrain outputs to be positive.", metavar=None), _StoreAction(option_strings=['--spectra_target_floor'], dest='spectra_target_floor', nargs=None, const=None, default=1e-08, type=<class 'float'>, choices=None, help='(float, default=1e-08) Values in targets for dataset type spectra are replaced with this value, intended to be a small positive number used to enforce positive values.', metavar=None), _StoreAction(option_strings=['--evidential_regularization'], dest='evidential_regularization', nargs=None, const=None, default=0, type=<class 'float'>, choices=None, help='(float, default=0) Value used in regularization for evidential loss function. Value used in literature was 1.', metavar=None), _StoreTrueAction(option_strings=['--overwrite_default_atom_features'], dest='overwrite_default_atom_features', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Overwrites the default atom descriptors with the new ones instead of concatenating them.\n    Can only be used if atom_descriptors are used as a feature.', metavar=None), _StoreTrueAction(option_strings=['--no_atom_descriptor_scaling'], dest='no_atom_descriptor_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off atom feature scaling.', metavar=None), _StoreTrueAction(option_strings=['--overwrite_default_bond_features'], dest='overwrite_default_bond_features', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Overwrites the default atom descriptors with the new ones instead of concatenating them', metavar=None), _StoreTrueAction(option_strings=['--no_bond_features_scaling'], dest='no_bond_features_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off atom feature scaling.', metavar=None), _StoreAction(option_strings=['--frzn_ffn_layers'], dest='frzn_ffn_layers', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Overwrites weights for the first n layers of the ffn from checkpoint model (specified checkpoint_frzn),\n    where n is specified in the input.\n    Automatically also freezes mpnn weights.', metavar=None), _StoreTrueAction(option_strings=['--freeze_first_only'], dest='freeze_first_only', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Determines whether or not to use checkpoint_frzn for just the first encoder.\n    Default (False) is to use the checkpoint to freeze all encoders.\n    (only relevant for number_of_molecules > 1, where checkpoint model has number_of_molecules = 1)', metavar=None), _StoreAction(option_strings=['--smiles_columns'], dest='smiles_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) List of names of the columns containing SMILES strings.\n    By default, uses the first :code:`number_of_molecules` columns.', metavar=None), _StoreAction(option_strings=['--number_of_molecules'], dest='number_of_molecules', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of molecules in each input to the model.\n    This must equal the length of :code:`smiles_columns` (if not :code:`None`).', metavar=None), _StoreAction(option_strings=['--checkpoint_dir'], dest='checkpoint_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory from which to load model checkpoints (walks directory and ensembles all models that are found).', metavar=None), _StoreAction(option_strings=['--checkpoint_path'], dest='checkpoint_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to model checkpoint (:code:`.pt` file).', metavar=None), _StoreAction(option_strings=['--checkpoint_paths'], dest='checkpoint_paths', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) List of paths to model checkpoints (:code:`.pt` files).', metavar=None), _StoreTrueAction(option_strings=['--no_cuda'], dest='no_cuda', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off cuda (i.e., use CPU instead of GPU).', metavar=None), _StoreAction(option_strings=['--gpu'], dest='gpu', nargs=None, const=None, default=None, type=<class 'int'>, choices=[], help='(int, default=None) Which GPU to use.', metavar=None), _StoreAction(option_strings=['--features_generator'], dest='features_generator', nargs='*', const=None, default=None, type=<class 'str'>, choices=['morgan', 'morgan_count', 'rdkit_2d', 'rdkit_2d_normalized'], help='(List[str], default=None) Method(s) of generating additional features.', metavar=None), _StoreAction(option_strings=['--features_path'], dest='features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path(s) to features to use in FNN (instead of features_generator).', metavar=None), _StoreAction(option_strings=['--phase_features_path'], dest='phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to features used to indicate the phase of the data in one-hot vector form. Used in spectra datatype.', metavar=None), _StoreTrueAction(option_strings=['--no_features_scaling'], dest='no_features_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off scaling of features.', metavar=None), _StoreAction(option_strings=['--max_data_size'], dest='max_data_size', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Maximum number of data points to load.', metavar=None), _StoreAction(option_strings=['--num_workers'], dest='num_workers', nargs=None, const=None, default=8, type=<class 'int'>, choices=None, help='(int, default=8) Number of workers for the parallel data loading (0 means sequential).', metavar=None), _StoreAction(option_strings=['--batch_size'], dest='batch_size', nargs=None, const=None, default=50, type=<class 'int'>, choices=None, help='(int, default=50) Batch size.', metavar=None), _StoreAction(option_strings=['--atom_descriptors'], dest='atom_descriptors', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b672a5c10>, choices=['feature', 'descriptor'], help="(Literal['feature', 'descriptor'], default=None) Custom extra atom descriptors.\n    :code:`feature`: used as atom features to featurize a given molecule.\n    :code:`descriptor`: used as descriptor and concatenated to the machine learned atomic representation.", metavar=None), _StoreAction(option_strings=['--atom_descriptors_path'], dest='atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to the extra atom descriptors.', metavar=None), _StoreAction(option_strings=['--bond_features_path'], dest='bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to the extra bond descriptors that will be used as bond features to featurize a given molecule.', metavar=None), _StoreTrueAction(option_strings=['--no_cache_mol'], dest='no_cache_mol', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to not cache the RDKit molecule for each SMILES string to reduce memory usage (cached by default).', metavar=None), _StoreTrueAction(option_strings=['--empty_cache'], dest='empty_cache', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to empty all caches before training or predicting. This is necessary if multiple jobs are run within a single script and the atom or bond features change.', metavar=None), _HelpAction(option_strings=['-h', '--help'], dest='help', nargs=0, const=None, default='==SUPPRESS==', type=None, choices=None, help='show this help message and exit', metavar=None)], '_option_string_actions': {'--data_path': _StoreAction(option_strings=['--data_path'], dest='data_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, required) Path to data CSV file.', metavar=None), '--target_columns': _StoreAction(option_strings=['--target_columns'], dest='target_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Name of the columns containing target values.\n    By default, uses all columns except the SMILES column and the :code:`ignore_columns`.', metavar=None), '--ignore_columns': _StoreAction(option_strings=['--ignore_columns'], dest='ignore_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Name of the columns to ignore when :code:`target_columns` is not provided.', metavar=None), '--dataset_type': _StoreAction(option_strings=['--dataset_type'], dest='dataset_type', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205ee0>, choices=['regression', 'classification', 'multiclass', 'spectra'], help="(Literal['regression', 'classification', 'multiclass', 'spectra'], required) Type of dataset. This determines the default loss function used during training.", metavar=None), '--loss_function': _StoreAction(option_strings=['--loss_function'], dest='loss_function', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205f70>, choices=['mse', 'bounded_mse', 'binary_cross_entropy', 'cross_entropy', 'mcc', 'sid', 'wasserstein', 'mve', 'evidential', 'dirichlet'], help="(Literal['mse', 'bounded_mse', 'binary_cross_entropy', 'cross_entropy', 'mcc', 'sid', 'wasserstein', 'mve', 'evidential', 'dirichlet'], default=None) Choice of loss function. Loss functions are limited to compatible dataset types.", metavar=None), '--multiclass_num_classes': _StoreAction(option_strings=['--multiclass_num_classes'], dest='multiclass_num_classes', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of classes when running multiclass classification.', metavar=None), '--separate_val_path': _StoreAction(option_strings=['--separate_val_path'], dest='separate_val_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to separate val set, optional.', metavar=None), '--separate_test_path': _StoreAction(option_strings=['--separate_test_path'], dest='separate_test_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to separate test set, optional.', metavar=None), '--spectra_phase_mask_path': _StoreAction(option_strings=['--spectra_phase_mask_path'], dest='spectra_phase_mask_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to a file containing a phase mask array, used for excluding particular regions in spectra predictions.', metavar=None), '--data_weights_path': _StoreAction(option_strings=['--data_weights_path'], dest='data_weights_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to weights for each molecule in the training data, affecting the relative weight of molecules in the loss function', metavar=None), '--target_weights': _StoreAction(option_strings=['--target_weights'], dest='target_weights', nargs='*', const=None, default=None, type=<class 'float'>, choices=None, help='(List[float], default=None) Weights associated with each target, affecting the relative weight of targets in the loss function. Must match the number of target columns.', metavar=None), '--split_type': _StoreAction(option_strings=['--split_type'], dest='split_type', nargs=None, const=None, default='random', type=<function get_literals.<locals>.var_type at 0x7f4b67205e50>, choices=['random', 'scaffold_balanced', 'predetermined', 'crossval', 'cv', 'cv-no-test', 'index_predetermined', 'random_with_repeated_smiles'], help="(Literal['random', 'scaffold_balanced', 'predetermined', 'crossval', 'cv', 'cv-no-test', 'index_predetermined', 'random_with_repeated_smiles'], default=random) Method of splitting the data into train/val/test.", metavar=None), '--split_sizes': _StoreAction(option_strings=['--split_sizes'], dest='split_sizes', nargs='*', const=None, default=None, type=<class 'float'>, choices=None, help='(List[float], default=None) Split proportions for train/validation/test sets.', metavar=None), '--split_key_molecule': _StoreAction(option_strings=['--split_key_molecule'], dest='split_key_molecule', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) The index of the key molecule used for splitting when multiple molecules are present and constrained split_type is used, like scaffold_balanced or random_with_repeated_smiles.\n       Note that this index begins with zero for the first molecule.', metavar=None), '--num_folds': _StoreAction(option_strings=['--num_folds'], dest='num_folds', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of folds when performing cross validation.', metavar=None), '--folds_file': _StoreAction(option_strings=['--folds_file'], dest='folds_file', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Optional file of fold labels.', metavar=None), '--val_fold_index': _StoreAction(option_strings=['--val_fold_index'], dest='val_fold_index', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Which fold to use as val for leave-one-out cross val.', metavar=None), '--test_fold_index': _StoreAction(option_strings=['--test_fold_index'], dest='test_fold_index', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Which fold to use as test for leave-one-out cross val.', metavar=None), '--crossval_index_dir': _StoreAction(option_strings=['--crossval_index_dir'], dest='crossval_index_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory in which to find cross validation index files.', metavar=None), '--crossval_index_file': _StoreAction(option_strings=['--crossval_index_file'], dest='crossval_index_file', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Indices of files to use as train/val/test. Overrides :code:`--num_folds` and :code:`--seed`.', metavar=None), '--seed': _StoreAction(option_strings=['--seed'], dest='seed', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Random seed to use when splitting data into train/val/test sets.\n    When :code`num_folds > 1`, the first fold uses this seed and all subsequent folds add 1 to the seed.', metavar=None), '--pytorch_seed': _StoreAction(option_strings=['--pytorch_seed'], dest='pytorch_seed', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Seed for PyTorch randomness (e.g., random initial weights).', metavar=None), '--metric': _StoreAction(option_strings=['--metric'], dest='metric', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b67205d30>, choices=['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse'], help='(Literal[\'auc\', \'prc-auc\', \'rmse\', \'mae\', \'mse\', \'r2\', \'accuracy\', \'cross_entropy\', \'binary_cross_entropy\', \'sid\', \'wasserstein\', \'f1\', \'mcc\', \'bounded_rmse\', \'bounded_mae\', \'bounded_mse\'], default=None) Metric to use during evaluation. It is also used with the validation set for early stopping.\n    Defaults to "auc" for classification, "rmse" for regression, and "sid" for spectra.', metavar=None), '--extra_metrics': _StoreAction(option_strings=['--extra_metrics'], dest='extra_metrics', nargs='*', const=None, default=[], type=<function get_literals.<locals>.var_type at 0x7f4b67205b80>, choices=['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse'], help="(List[Literal['auc', 'prc-auc', 'rmse', 'mae', 'mse', 'r2', 'accuracy', 'cross_entropy', 'binary_cross_entropy', 'sid', 'wasserstein', 'f1', 'mcc', 'bounded_rmse', 'bounded_mae', 'bounded_mse']], default=[]) Additional metrics to use to evaluate the model. Not used for early stopping.", metavar=None), '--save_dir': _StoreAction(option_strings=['--save_dir'], dest='save_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory where model checkpoints will be saved.', metavar=None), '--checkpoint_frzn': _StoreAction(option_strings=['--checkpoint_frzn'], dest='checkpoint_frzn', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to model checkpoint file to be loaded for overwriting and freezing weights.', metavar=None), '--save_smiles_splits': _StoreTrueAction(option_strings=['--save_smiles_splits'], dest='save_smiles_splits', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Save smiles for each train/val/test splits for prediction convenience later.', metavar=None), '--test': _StoreTrueAction(option_strings=['--test'], dest='test', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to skip training and only test the model.', metavar=None), '--quiet': _StoreTrueAction(option_strings=['--quiet'], dest='quiet', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Skip non-essential print statements.', metavar=None), '--log_frequency': _StoreAction(option_strings=['--log_frequency'], dest='log_frequency', nargs=None, const=None, default=10, type=<class 'int'>, choices=None, help='(int, default=10) The number of batches between each logging of the training loss.', metavar=None), '--show_individual_scores': _StoreTrueAction(option_strings=['--show_individual_scores'], dest='show_individual_scores', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Show all scores for individual targets, not just average, at the end.', metavar=None), '--cache_cutoff': _StoreAction(option_strings=['--cache_cutoff'], dest='cache_cutoff', nargs=None, const=None, default=10000, type=<class 'float'>, choices=None, help='(float, default=10000) Maximum number of molecules in dataset to allow caching.\n    Below this number, caching is used and data loading is sequential.\n    Above this number, caching is not used and data loading is parallel.\n    Use "inf" to always cache.', metavar=None), '--save_preds': _StoreTrueAction(option_strings=['--save_preds'], dest='save_preds', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to save test split predictions during training.', metavar=None), '--resume_experiment': _StoreTrueAction(option_strings=['--resume_experiment'], dest='resume_experiment', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to resume the experiment.\n    Loads test results from any folds that have already been completed and skips training those folds.', metavar=None), '--bias': _StoreTrueAction(option_strings=['--bias'], dest='bias', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to add bias to linear layers.', metavar=None), '--hidden_size': _StoreAction(option_strings=['--hidden_size'], dest='hidden_size', nargs=None, const=None, default=300, type=<class 'int'>, choices=None, help='(int, default=300) Dimensionality of hidden layers in MPN.', metavar=None), '--depth': _StoreAction(option_strings=['--depth'], dest='depth', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of message passing steps.', metavar=None), '--bias_solvent': _StoreTrueAction(option_strings=['--bias_solvent'], dest='bias_solvent', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to add bias to linear layers for solvent MPN if :code:`reaction_solvent` is True.', metavar=None), '--hidden_size_solvent': _StoreAction(option_strings=['--hidden_size_solvent'], dest='hidden_size_solvent', nargs=None, const=None, default=300, type=<class 'int'>, choices=None, help='(int, default=300) Dimensionality of hidden layers in solvent MPN if :code:`reaction_solvent` is True.', metavar=None), '--depth_solvent': _StoreAction(option_strings=['--depth_solvent'], dest='depth_solvent', nargs=None, const=None, default=3, type=<class 'int'>, choices=None, help='(int, default=3) Number of message passing steps for solvent if :code:`reaction_solvent` is True.', metavar=None), '--mpn_shared': _StoreTrueAction(option_strings=['--mpn_shared'], dest='mpn_shared', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to use the same message passing neural network for all input molecules\n    Only relevant if :code:`number_of_molecules > 1`', metavar=None), '--dropout': _StoreAction(option_strings=['--dropout'], dest='dropout', nargs=None, const=None, default=0.0, type=<class 'float'>, choices=None, help='(float, default=0.0) Dropout probability.', metavar=None), '--activation': _StoreAction(option_strings=['--activation'], dest='activation', nargs=None, const=None, default='ReLU', type=<function get_literals.<locals>.var_type at 0x7f4b67205af0>, choices=['ReLU', 'LeakyReLU', 'PReLU', 'tanh', 'SELU', 'ELU'], help="(Literal['ReLU', 'LeakyReLU', 'PReLU', 'tanh', 'SELU', 'ELU'], default=ReLU) Activation function.", metavar=None), '--atom_messages': _StoreTrueAction(option_strings=['--atom_messages'], dest='atom_messages', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Centers messages on atoms instead of on bonds.', metavar=None), '--undirected': _StoreTrueAction(option_strings=['--undirected'], dest='undirected', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Undirected edges (always sum the two relevant bond vectors).', metavar=None), '--ffn_hidden_size': _StoreAction(option_strings=['--ffn_hidden_size'], dest='ffn_hidden_size', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Hidden dim for higher-capacity FFN (defaults to hidden_size).', metavar=None), '--ffn_num_layers': _StoreAction(option_strings=['--ffn_num_layers'], dest='ffn_num_layers', nargs=None, const=None, default=2, type=<class 'int'>, choices=None, help='(int, default=2) Number of layers in FFN after MPN encoding.', metavar=None), '--features_only': _StoreTrueAction(option_strings=['--features_only'], dest='features_only', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Use only the additional features in an FFN, no graph network.', metavar=None), '--separate_val_features_path': _StoreAction(option_strings=['--separate_val_features_path'], dest='separate_val_features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path to file with features for separate val set.', metavar=None), '--separate_test_features_path': _StoreAction(option_strings=['--separate_test_features_path'], dest='separate_test_features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path to file with features for separate test set.', metavar=None), '--separate_val_phase_features_path': _StoreAction(option_strings=['--separate_val_phase_features_path'], dest='separate_val_phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with phase features for separate val set.', metavar=None), '--separate_test_phase_features_path': _StoreAction(option_strings=['--separate_test_phase_features_path'], dest='separate_test_phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with phase features for separate test set.', metavar=None), '--separate_val_atom_descriptors_path': _StoreAction(option_strings=['--separate_val_atom_descriptors_path'], dest='separate_val_atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate val set.', metavar=None), '--separate_test_atom_descriptors_path': _StoreAction(option_strings=['--separate_test_atom_descriptors_path'], dest='separate_test_atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate test set.', metavar=None), '--separate_val_bond_features_path': _StoreAction(option_strings=['--separate_val_bond_features_path'], dest='separate_val_bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate val set.', metavar=None), '--separate_test_bond_features_path': _StoreAction(option_strings=['--separate_test_bond_features_path'], dest='separate_test_bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to file with extra atom descriptors for separate test set.', metavar=None), '--config_path': _StoreAction(option_strings=['--config_path'], dest='config_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to a :code:`.json` file containing arguments. Any arguments present in the config file\n    will override arguments specified via the command line or by the defaults.', metavar=None), '--ensemble_size': _StoreAction(option_strings=['--ensemble_size'], dest='ensemble_size', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of models in ensemble.', metavar=None), '--aggregation': _StoreAction(option_strings=['--aggregation'], dest='aggregation', nargs=None, const=None, default='mean', type=<function get_literals.<locals>.var_type at 0x7f4b67205160>, choices=['mean', 'sum', 'norm'], help="(Literal['mean', 'sum', 'norm'], default=mean) Aggregation scheme for atomic vectors into molecular vectors", metavar=None), '--aggregation_norm': _StoreAction(option_strings=['--aggregation_norm'], dest='aggregation_norm', nargs=None, const=None, default=100, type=<class 'int'>, choices=None, help='(int, default=100) For norm aggregation, number by which to divide summed up atomic features', metavar=None), '--reaction': _StoreTrueAction(option_strings=['--reaction'], dest='reaction', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to adjust MPNN layer to take reactions as input instead of molecules.', metavar=None), '--reaction_mode': _StoreAction(option_strings=['--reaction_mode'], dest='reaction_mode', nargs=None, const=None, default='reac_diff', type=<function get_literals.<locals>.var_type at 0x7f4b67205280>, choices=['reac_prod', 'reac_diff', 'prod_diff', 'reac_prod_balance', 'reac_diff_balance', 'prod_diff_balance'], help="(Literal['reac_prod', 'reac_diff', 'prod_diff', 'reac_prod_balance', 'reac_diff_balance', 'prod_diff_balance'], default=reac_diff) Choices for construction of atom and bond features for reactions\n    :code:`reac_prod`: concatenates the reactants feature with the products feature.\n    :code:`reac_diff`: concatenates the reactants feature with the difference in features between reactants and products.\n    :code:`prod_diff`: concatenates the products feature with the difference in features between reactants and products.\n    :code:`reac_prod_balance`: concatenates the reactants feature with the products feature, balances imbalanced reactions.\n    :code:`reac_diff_balance`: concatenates the reactants feature with the difference in features between reactants and products, balances imbalanced reactions.\n    :code:`prod_diff_balance`: concatenates the products feature with the difference in features between reactants and products, balances imbalanced reactions.", metavar=None), '--reaction_solvent': _StoreTrueAction(option_strings=['--reaction_solvent'], dest='reaction_solvent', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to adjust the MPNN layer to take as input a reaction and a molecule, and to encode them with separate MPNNs.', metavar=None), '--explicit_h': _StoreTrueAction(option_strings=['--explicit_h'], dest='explicit_h', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether H are explicitly specified in input (and should be kept this way). This option is intended to be used\n    with the :code:`reaction` or :code:`reaction_solvent` options, and applies only to the reaction part.', metavar=None), '--adding_h': _StoreTrueAction(option_strings=['--adding_h'], dest='adding_h', nargs=0, const=True, default=False, type=None, choices=None, help="(bool, default=False) Whether RDKit molecules will be constructed with adding the Hs to them. This option is intended to be used\n    with Chemprop's default molecule or multi-molecule encoders, or in :code:`reaction_solvent` mode where it applies to the solvent only.", metavar=None), '--epochs': _StoreAction(option_strings=['--epochs'], dest='epochs', nargs=None, const=None, default=30, type=<class 'int'>, choices=None, help='(int, default=30) Number of epochs to run.', metavar=None), '--warmup_epochs': _StoreAction(option_strings=['--warmup_epochs'], dest='warmup_epochs', nargs=None, const=None, default=2.0, type=<class 'float'>, choices=None, help='(float, default=2.0) Number of epochs during which learning rate increases linearly from :code:`init_lr` to :code:`max_lr`.\n    Afterwards, learning rate decreases exponentially from :code:`max_lr` to :code:`final_lr`.', metavar=None), '--init_lr': _StoreAction(option_strings=['--init_lr'], dest='init_lr', nargs=None, const=None, default=0.0001, type=<class 'float'>, choices=None, help='(float, default=0.0001) Initial learning rate.', metavar=None), '--max_lr': _StoreAction(option_strings=['--max_lr'], dest='max_lr', nargs=None, const=None, default=0.001, type=<class 'float'>, choices=None, help='(float, default=0.001) Maximum learning rate.', metavar=None), '--final_lr': _StoreAction(option_strings=['--final_lr'], dest='final_lr', nargs=None, const=None, default=0.0001, type=<class 'float'>, choices=None, help='(float, default=0.0001) Final learning rate.', metavar=None), '--grad_clip': _StoreAction(option_strings=['--grad_clip'], dest='grad_clip', nargs=None, const=None, default=None, type=<class 'float'>, choices=None, help='(float, default=None) Maximum magnitude of gradient during training.', metavar=None), '--class_balance': _StoreTrueAction(option_strings=['--class_balance'], dest='class_balance', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Trains with an equal number of positives and negatives in each batch.', metavar=None), '--spectra_activation': _StoreAction(option_strings=['--spectra_activation'], dest='spectra_activation', nargs=None, const=None, default='exp', type=<function get_literals.<locals>.var_type at 0x7f4b672eb280>, choices=['exp', 'softplus'], help="(Literal['exp', 'softplus'], default=exp) Indicates which function to use in dataset_type spectra training to constrain outputs to be positive.", metavar=None), '--spectra_target_floor': _StoreAction(option_strings=['--spectra_target_floor'], dest='spectra_target_floor', nargs=None, const=None, default=1e-08, type=<class 'float'>, choices=None, help='(float, default=1e-08) Values in targets for dataset type spectra are replaced with this value, intended to be a small positive number used to enforce positive values.', metavar=None), '--evidential_regularization': _StoreAction(option_strings=['--evidential_regularization'], dest='evidential_regularization', nargs=None, const=None, default=0, type=<class 'float'>, choices=None, help='(float, default=0) Value used in regularization for evidential loss function. Value used in literature was 1.', metavar=None), '--overwrite_default_atom_features': _StoreTrueAction(option_strings=['--overwrite_default_atom_features'], dest='overwrite_default_atom_features', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Overwrites the default atom descriptors with the new ones instead of concatenating them.\n    Can only be used if atom_descriptors are used as a feature.', metavar=None), '--no_atom_descriptor_scaling': _StoreTrueAction(option_strings=['--no_atom_descriptor_scaling'], dest='no_atom_descriptor_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off atom feature scaling.', metavar=None), '--overwrite_default_bond_features': _StoreTrueAction(option_strings=['--overwrite_default_bond_features'], dest='overwrite_default_bond_features', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Overwrites the default atom descriptors with the new ones instead of concatenating them', metavar=None), '--no_bond_features_scaling': _StoreTrueAction(option_strings=['--no_bond_features_scaling'], dest='no_bond_features_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off atom feature scaling.', metavar=None), '--frzn_ffn_layers': _StoreAction(option_strings=['--frzn_ffn_layers'], dest='frzn_ffn_layers', nargs=None, const=None, default=0, type=<class 'int'>, choices=None, help='(int, default=0) Overwrites weights for the first n layers of the ffn from checkpoint model (specified checkpoint_frzn),\n    where n is specified in the input.\n    Automatically also freezes mpnn weights.', metavar=None), '--freeze_first_only': _StoreTrueAction(option_strings=['--freeze_first_only'], dest='freeze_first_only', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Determines whether or not to use checkpoint_frzn for just the first encoder.\n    Default (False) is to use the checkpoint to freeze all encoders.\n    (only relevant for number_of_molecules > 1, where checkpoint model has number_of_molecules = 1)', metavar=None), '--smiles_columns': _StoreAction(option_strings=['--smiles_columns'], dest='smiles_columns', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) List of names of the columns containing SMILES strings.\n    By default, uses the first :code:`number_of_molecules` columns.', metavar=None), '--number_of_molecules': _StoreAction(option_strings=['--number_of_molecules'], dest='number_of_molecules', nargs=None, const=None, default=1, type=<class 'int'>, choices=None, help='(int, default=1) Number of molecules in each input to the model.\n    This must equal the length of :code:`smiles_columns` (if not :code:`None`).', metavar=None), '--checkpoint_dir': _StoreAction(option_strings=['--checkpoint_dir'], dest='checkpoint_dir', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Directory from which to load model checkpoints (walks directory and ensembles all models that are found).', metavar=None), '--checkpoint_path': _StoreAction(option_strings=['--checkpoint_path'], dest='checkpoint_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to model checkpoint (:code:`.pt` file).', metavar=None), '--checkpoint_paths': _StoreAction(option_strings=['--checkpoint_paths'], dest='checkpoint_paths', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) List of paths to model checkpoints (:code:`.pt` files).', metavar=None), '--no_cuda': _StoreTrueAction(option_strings=['--no_cuda'], dest='no_cuda', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off cuda (i.e., use CPU instead of GPU).', metavar=None), '--gpu': _StoreAction(option_strings=['--gpu'], dest='gpu', nargs=None, const=None, default=None, type=<class 'int'>, choices=[], help='(int, default=None) Which GPU to use.', metavar=None), '--features_generator': _StoreAction(option_strings=['--features_generator'], dest='features_generator', nargs='*', const=None, default=None, type=<class 'str'>, choices=['morgan', 'morgan_count', 'rdkit_2d', 'rdkit_2d_normalized'], help='(List[str], default=None) Method(s) of generating additional features.', metavar=None), '--features_path': _StoreAction(option_strings=['--features_path'], dest='features_path', nargs='*', const=None, default=None, type=<class 'str'>, choices=None, help='(List[str], default=None) Path(s) to features to use in FNN (instead of features_generator).', metavar=None), '--phase_features_path': _StoreAction(option_strings=['--phase_features_path'], dest='phase_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to features used to indicate the phase of the data in one-hot vector form. Used in spectra datatype.', metavar=None), '--no_features_scaling': _StoreTrueAction(option_strings=['--no_features_scaling'], dest='no_features_scaling', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Turn off scaling of features.', metavar=None), '--max_data_size': _StoreAction(option_strings=['--max_data_size'], dest='max_data_size', nargs=None, const=None, default=None, type=<class 'int'>, choices=None, help='(int, default=None) Maximum number of data points to load.', metavar=None), '--num_workers': _StoreAction(option_strings=['--num_workers'], dest='num_workers', nargs=None, const=None, default=8, type=<class 'int'>, choices=None, help='(int, default=8) Number of workers for the parallel data loading (0 means sequential).', metavar=None), '--batch_size': _StoreAction(option_strings=['--batch_size'], dest='batch_size', nargs=None, const=None, default=50, type=<class 'int'>, choices=None, help='(int, default=50) Batch size.', metavar=None), '--atom_descriptors': _StoreAction(option_strings=['--atom_descriptors'], dest='atom_descriptors', nargs=None, const=None, default=None, type=<function get_literals.<locals>.var_type at 0x7f4b672a5c10>, choices=['feature', 'descriptor'], help="(Literal['feature', 'descriptor'], default=None) Custom extra atom descriptors.\n    :code:`feature`: used as atom features to featurize a given molecule.\n    :code:`descriptor`: used as descriptor and concatenated to the machine learned atomic representation.", metavar=None), '--atom_descriptors_path': _StoreAction(option_strings=['--atom_descriptors_path'], dest='atom_descriptors_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to the extra atom descriptors.', metavar=None), '--bond_features_path': _StoreAction(option_strings=['--bond_features_path'], dest='bond_features_path', nargs=None, const=None, default=None, type=<class 'str'>, choices=None, help='(str, default=None) Path to the extra bond descriptors that will be used as bond features to featurize a given molecule.', metavar=None), '--no_cache_mol': _StoreTrueAction(option_strings=['--no_cache_mol'], dest='no_cache_mol', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to not cache the RDKit molecule for each SMILES string to reduce memory usage (cached by default).', metavar=None), '--empty_cache': _StoreTrueAction(option_strings=['--empty_cache'], dest='empty_cache', nargs=0, const=True, default=False, type=None, choices=None, help='(bool, default=False) Whether to empty all caches before training or predicting. This is necessary if multiple jobs are run within a single script and the atom or bond features change.', metavar=None), '-h': _HelpAction(option_strings=['-h', '--help'], dest='help', nargs=0, const=None, default='==SUPPRESS==', type=None, choices=None, help='show this help message and exit', metavar=None), '--help': _HelpAction(option_strings=['-h', '--help'], dest='help', nargs=0, const=None, default='==SUPPRESS==', type=None, choices=None, help='show this help message and exit', metavar=None)}, '_action_groups': [<argparse._ArgumentGroup object at 0x7f4b673a5fa0>, <argparse._ArgumentGroup object at 0x7f4b673a57f0>], '_mutually_exclusive_groups': [], '_defaults': {}, '_negative_number_matcher': re.compile('^-\\d+$|^-\\d*\\.\\d+$'), '_has_negative_number_optionals': [], 'prog': '__main__.py', 'usage': None, 'epilog': None, 'formatter_class': <class 'argparse.HelpFormatter'>, 'fromfile_prefix_chars': None, 'add_help': True, 'allow_abbrev': True, '_positionals': <argparse._ArgumentGroup object at 0x7f4b673a5fa0>, '_optionals': <argparse._ArgumentGroup object at 0x7f4b673a57f0>, '_subparsers': None, 'args_from_configs': [], '_atom_features_size': 0, '_bond_features_size': 0, '_atom_descriptors_size': 0, '_task_names': None, '_crossval_index_sets': None, '_num_tasks': None, '_features_size': None, '_train_data_size': None, 'data_path': './CMPNN/data/tox21.csv', 'target_columns': None, 'ignore_columns': None, 'dataset_type': 'classification', 'loss_function': 'binary_cross_entropy', 'multiclass_num_classes': 3, 'separate_val_path': None, 'separate_test_path': None, 'spectra_phase_mask_path': None, 'data_weights_path': None, 'target_weights': None, 'split_type': 'scaffold_balanced', 'split_sizes': [0.8, 0.1, 0.1], 'split_key_molecule': 0, 'num_folds': 1, 'folds_file': None, 'val_fold_index': None, 'test_fold_index': None, 'crossval_index_dir': None, 'crossval_index_file': None, 'seed': 0, 'pytorch_seed': 0, 'metric': 'auc', 'extra_metrics': ['mcc'], 'save_dir': 'example/gnn_results/', 'checkpoint_frzn': None, 'save_smiles_splits': False, 'test': False, 'quiet': False, 'log_frequency': 10, 'show_individual_scores': False, 'cache_cutoff': 10000, 'save_preds': False, 'resume_experiment': False, 'bias': False, 'hidden_size': 300, 'depth': 3, 'bias_solvent': False, 'hidden_size_solvent': 300, 'depth_solvent': 3, 'mpn_shared': False, 'dropout': 0.0, 'activation': 'ReLU', 'atom_messages': False, 'undirected': False, 'ffn_hidden_size': 300, 'ffn_num_layers': 2, 'features_only': False, 'separate_val_features_path': None, 'separate_test_features_path': None, 'separate_val_phase_features_path': None, 'separate_test_phase_features_path': None, 'separate_val_atom_descriptors_path': None, 'separate_test_atom_descriptors_path': None, 'separate_val_bond_features_path': None, 'separate_test_bond_features_path': None, 'config_path': None, 'ensemble_size': 1, 'aggregation': 'mean', 'aggregation_norm': 100, 'reaction': False, 'reaction_mode': 'reac_diff', 'reaction_solvent': False, 'explicit_h': False, 'adding_h': False, 'epochs': 5, 'warmup_epochs': 2.0, 'init_lr': 0.0001, 'max_lr': 0.001, 'final_lr': 0.0001, 'grad_clip': None, 'class_balance': True, 'spectra_activation': 'exp', 'spectra_target_floor': 1e-08, 'evidential_regularization': 0, 'overwrite_default_atom_features': False, 'no_atom_descriptor_scaling': False, 'overwrite_default_bond_features': False, 'no_bond_features_scaling': False, 'frzn_ffn_layers': 0, 'freeze_first_only': False, 'smiles_columns': ['smiles'], 'number_of_molecules': 1, 'checkpoint_dir': None, 'checkpoint_path': None, 'checkpoint_paths': None, 'no_cuda': False, 'gpu': None, 'features_generator': None, 'features_path': None, 'phase_features_path': None, 'no_features_scaling': False, 'max_data_size': None, 'num_workers': 8, 'batch_size': 50, 'atom_descriptors': None, 'atom_descriptors_path': None, 'bond_features_path': None, 'no_cache_mol': False, 'empty_cache': False}
2022-11-08 09:29:25,694 INFO    MainThread:28241 [wandb_init.py:init():569] starting backend
2022-11-08 09:29:25,694 INFO    MainThread:28241 [wandb_init.py:init():573] setting up manager
2022-11-08 09:29:25,703 INFO    MainThread:28241 [backend.py:_multiprocessing_setup():102] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-11-08 09:29:25,709 INFO    MainThread:28241 [wandb_init.py:init():580] backend started and connected
2022-11-08 09:29:26,054 INFO    MainThread:28241 [wandb_init.py:init():658] updated telemetry
2022-11-08 09:29:26,077 INFO    MainThread:28241 [wandb_init.py:init():692] communicating run to backend with 30 second timeout
2022-11-08 09:29:27,460 INFO    MainThread:28241 [wandb_run.py:_on_init():1974] communicating current version
2022-11-08 09:29:27,551 INFO    MainThread:28241 [wandb_run.py:_on_init():1978] got version response upgrade_message: "wandb version 0.13.5 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-11-08 09:29:27,551 INFO    MainThread:28241 [wandb_init.py:init():727] starting run threads in backend
2022-11-08 09:29:28,961 INFO    MainThread:28241 [wandb_run.py:_console_start():1954] atexit reg
2022-11-08 09:29:28,968 INFO    MainThread:28241 [wandb_run.py:_redirect():1812] redirect: SettingsConsole.WRAP_RAW
2022-11-08 09:29:28,969 INFO    MainThread:28241 [wandb_run.py:_redirect():1877] Wrapping output streams.
2022-11-08 09:29:28,969 INFO    MainThread:28241 [wandb_run.py:_redirect():1899] Redirects installed.
2022-11-08 09:29:28,970 INFO    MainThread:28241 [wandb_init.py:init():764] run started, returning control to user process
