Splitting data with seed 719322461
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5919/5919 [00:01<00:00, 5329.26it/s]
Total scaffolds = 1,775 | train scaffolds = 1,141 | val scaffolds = 335 | test scaffolds = 299
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 1,414 | target average = 0.048091
Scaffold 1
Task 0: count = 1,164 | target average = 0.103952
Scaffold 2
Task 0: count = 80 | target average = 0.025000
Scaffold 3
Task 0: count = 54 | target average = 0.037037
Scaffold 4
Task 0: count = 53 | target average = 0.169811
Scaffold 5
Task 0: count = 44 | target average = 0.295455
Scaffold 6
Task 0: count = 37 | target average = 1.000000
Scaffold 7
Task 0: count = 36 | target average = 1.000000
Scaffold 8
Task 0: count = 33 | target average = 0.333333
Scaffold 9
Task 0: count = 30 | target average = 0.266667
Class sizes
AR 0: 82.11%, 1: 17.89%
Total size = 5,919 | train size = 4,735 | val size = 591 | test size = 593
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                                                                                                    | 0/1 [00:00<?, ?it/s]Epoch 0
  8%|███████████████▋                                                                                                                                                                           | 8/95 [00:00<00:07, 11.91it/s]Loss = 4.3875e-01, PNorm = 34.0190, GNorm = 0.2139, lr_0 = 2.0053e-04
 19%|███████████████████████████████████▏                                                                                                                                                      | 18/95 [00:01<00:06, 11.01it/s]
 31%|████████████████████████████████████████████████████████▊                                                                                                                                 | 29/95 [00:03<00:10,  6.22it/s]Loss = 4.3305e-01, PNorm = 34.0311, GNorm = 1.0318, lr_0 = 2.9628e-04
 41%|████████████████████████████████████████████████████████████████████████████▎                                                                                                             | 39/95 [00:04<00:06,  8.78it/s]
 52%|███████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                          | 49/95 [00:05<00:05,  9.17it/s]Loss = 3.9714e-01, PNorm = 34.0493, GNorm = 0.4012, lr_0 = 3.9202e-04
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                        | 58/95 [00:06<00:03,  9.39it/s]
 72%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 68/95 [00:07<00:03,  8.89it/s]Loss = 3.9816e-01, PNorm = 34.0717, GNorm = 0.9190, lr_0 = 4.8777e-04
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                               | 79/95 [00:08<00:01,  8.51it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 88/95 [00:09<00:01,  6.63it/s]

Validation prc-auc = 0.624661
Training binary_cross_entropy = 0.371214
Training prc-auc = 0.750864
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:14<00:00, 14.81s/it]
Model 0 best validation binary_cross_entropy = 0.551679 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test binary_cross_entropy = 0.564000
Model 0 test AR binary_cross_entropy = 0.564000
Model 0 test prc-auc = 0.804161
Model 0 test AR prc-auc = 0.804161
Ensemble test binary_cross_entropy = 0.564000
Ensemble test AR binary_cross_entropy = 0.564000
Ensemble test prc-auc = 0.804161
Ensemble test AR prc-auc = 0.804161
2-fold cross validation
	Seed 719322460 ==> test binary_cross_entropy = 0.602263
		Seed 719322460 ==> test AR binary_cross_entropy = 0.602263
	Seed 719322460 ==> test prc-auc = 0.718085
		Seed 719322460 ==> test AR prc-auc = 0.718085
	Seed 719322461 ==> test binary_cross_entropy = 0.564000
		Seed 719322461 ==> test AR binary_cross_entropy = 0.564000
	Seed 719322461 ==> test prc-auc = 0.804161
		Seed 719322461 ==> test AR prc-auc = 0.804161
Overall test binary_cross_entropy = 0.583131 +/- 0.019131
	Overall test AR binary_cross_entropy = 0.583131 +/- 0.019131
Overall test prc-auc = 0.761123 +/- 0.043038
	Overall test AR prc-auc = 0.761123 +/- 0.043038
Elapsed time = 0:00:46
Results: 0.58313 +/- 0.01913