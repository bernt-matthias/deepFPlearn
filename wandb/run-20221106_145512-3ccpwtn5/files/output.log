Loading data
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7831/7831 [00:00<00:00, 10726.58it/s]
Number of tasks = 12
Splitting data with seed 0
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7831/7831 [00:00<00:00, 9018.54it/s]
Total scaffolds = 2,326 | train scaffolds = 1,535 | val scaffolds = 367 | test scaffolds = 424
====================================================================================================
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels: [(array([0.01736614, 0.0152439 , 0.12600321, 0.02879581, 0.11440329,
       0.03917221, 0.01794072, 0.11601307, 0.0257732 , 0.04442771,
       0.16479724, 0.03924528]), array([1382, 1312, 1246, 1146, 1215, 1353, 1282, 1224, 1358, 1328, 1159,
       1325])), (array([0.01056958, 0.01393939, 0.01355514, 0.01047806, 0.06081946,
       0.02207637, 0.02308627, 0.09354414, 0.02058824, 0.04649721,
       0.03804348, 0.02112251]), array([1703, 1650, 1623, 1527, 1562, 1676, 1646, 1518, 1700, 1613, 1472,
       1657])), (array([nan, nan,  0., nan, nan,  0.,  1., nan, nan,  0.,  1.,  1.]), array([0, 0, 4, 0, 0, 3, 1, 0, 0, 1, 4, 3])), (array([ 0.,  0.,  0.,  0.,  0.,  0.,  0., nan,  0., nan,  0.,  0.]), array([1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1])), (array([0.        , 0.        , 0.16666667, 0.02857143, 0.02857143,
       0.03846154, 0.        , 0.09333333, 0.03896104, 0.01298701,
       0.08571429, 0.01298701]), array([77, 74, 72, 70, 70, 78, 73, 75, 77, 77, 70, 77])), (array([0. , 0. , 0. , 1. , 1. , 1. , 0. , 0.5, 0. , 0. , 0.5, 0. ]), array([2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 2, 2])), (array([nan, nan, nan, nan, nan, nan, nan,  0., nan,  0., nan, nan]), array([0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0])), (array([ 0.,  0.,  0.,  0.,  0.,  0.,  0., nan,  0., nan, nan,  0.]), array([1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1])), (array([ 0.,  0.,  0.,  0.,  0.,  0.,  0., nan,  0., nan,  0.,  0.]), array([1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1])), (array([0.        , 0.        , 0.        , 0.        , 0.5       ,
       0.33333333, 0.        , 0.5       , 0.        , 0.        ,
       1.        , 0.        ]), array([2, 2, 2, 2, 2, 3, 1, 2, 3, 3, 1, 2]))]
Class sizes
NR-AR 0: 95.75%, 1: 4.25%
NR-AR-LBD 0: 96.49%, 1: 3.51%
NR-AhR 0: 88.27%, 1: 11.73%
NR-Aromatase 0: 94.85%, 1: 5.15%
NR-ER 0: 87.20%, 1: 12.80%
NR-ER-LBD 0: 94.97%, 1: 5.03%
NR-PPAR-gamma 0: 97.12%, 1: 2.88%
SR-ARE 0: 83.85%, 1: 16.15%
SR-ATAD5 0: 96.27%, 1: 3.73%
SR-HSE 0: 94.25%, 1: 5.75%
SR-MMP 0: 84.20%, 1: 15.80%
SR-p53 0: 93.76%, 1: 6.24%
Total size = 7,831 | train size = 6,264 | val size = 783 | test size = 784
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=2, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=2, out_features=12, bias=True)
  )
)
Number of parameters = 1,932,938
Epoch 0






























100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [01:01<00:00,  2.03it/s]
Validation auc = 0.500000
Model 0 best validation auc = 0.500000 on epoch 0
Model 0 test auc = 0.500000
Ensemble test auc = 0.500000
Results: 0.50000 +/- 0.00000
1-fold cross validation
Seed 0 ==> test auc = 0.500000
Overall test auc = 0.500000 +/- 0.000000