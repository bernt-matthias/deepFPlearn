Splitting data with seed 856170992
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5919/5919 [00:00<00:00, 8680.56it/s]
Total scaffolds = 1,775 | train scaffolds = 1,060 | val scaffolds = 354 | test scaffolds = 361
Label averages per scaffold, in decreasing order of scaffold frequency,capped at 10 scaffolds and 20 labels:
Scaffold 0
Task 0: count = 1,414 | target average = 0.048091
Scaffold 1
Task 0: count = 1,164 | target average = 0.103952
Scaffold 2
Task 0: count = 80 | target average = 0.025000
Scaffold 3
Task 0: count = 54 | target average = 0.037037
Scaffold 4
Task 0: count = 53 | target average = 0.169811
Scaffold 5
Task 0: count = 44 | target average = 0.295455
Scaffold 6
Task 0: count = 37 | target average = 1.000000
Scaffold 7
Task 0: count = 36 | target average = 1.000000
Scaffold 8
Task 0: count = 33 | target average = 0.333333
Scaffold 9
Task 0: count = 30 | target average = 0.266667
Class sizes
AR 0: 82.11%, 1: 17.89%
Total size = 5,919 | train size = 4,735 | val size = 591 | test size = 593
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
  0%|                                                                                                                                                                                                    | 0/1 [00:00<?, ?it/s]Epoch 0
                                                                                                                                                                                                                               Loss = 5.1628e-01, PNorm = 34.0151, GNorm = 0.3509, lr_0 = 1.5266e-04
  7%|█████████████▊                                                                                                                                                                             | 7/95 [00:00<00:04, 19.08it/s]
 20%|█████████████████████████████████████▏                                                                                                                                                    | 19/95 [00:01<00:04, 18.47it/s]Loss = 4.6047e-01, PNorm = 34.0226, GNorm = 0.2891, lr_0 = 2.4840e-04
 31%|████████████████████████████████████████████████████████▊                                                                                                                                 | 29/95 [00:01<00:03, 17.05it/s]Loss = 4.4993e-01, PNorm = 34.0319, GNorm = 0.4301, lr_0 = 2.9628e-04
 41%|████████████████████████████████████████████████████████████████████████████▎                                                                                                             | 39/95 [00:02<00:03, 17.89it/s]Loss = 4.0341e-01, PNorm = 34.0440, GNorm = 0.3036, lr_0 = 3.4415e-04
 49%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                              | 47/95 [00:02<00:02, 18.16it/s]
